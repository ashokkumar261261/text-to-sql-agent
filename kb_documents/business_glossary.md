# Business Glossary and Query Examples

## Business Terms and Definitions

### Customer Metrics
- **Customer**: Individual or entity that has registered and can place orders
- **Active Customer**: Customer who has placed at least one order
- **Top Customer**: Customer ranked by total revenue or order count
- **Customer Lifetime Value**: Total revenue generated by a customer over time
- **Customer Retention**: Customers who have made repeat purchases
- **New Customer**: Customer who registered recently (within last 30 days)

### Product Metrics
- **Trending Products**: Products with high order frequency or recent popularity
- **Best Selling Products**: Products with highest total quantity sold
- **Popular Products**: Products with most orders (by count)
- **High-Value Products**: Products with highest individual prices
- **Category Leaders**: Top products within each category
- **Low Stock Products**: Products with inventory below threshold (< 50 units)
- **Out of Stock**: Products with zero inventory

### Order Metrics
- **Revenue**: Total monetary value from orders (sum of total_amount)
- **Order Volume**: Total number of orders
- **Average Order Value (AOV)**: Average total_amount per order
- **Order Frequency**: How often orders are placed
- **Recent Orders**: Orders placed within last 7-30 days
- **High-Value Orders**: Orders above average order value

### Sales Performance
- **Sales by Category**: Revenue and order count grouped by product category
- **Sales Trends**: Order patterns over time periods
- **Regional Performance**: Sales performance by customer location (city, state)
- **Monthly/Quarterly Sales**: Revenue aggregated by time periods
- **Growth Rate**: Period-over-period sales increase/decrease

## Common Business Questions and SQL Patterns

### Customer Analysis Questions

**"Who are our top customers?"**
```sql
SELECT c.name, c.email, c.city, SUM(o.total_amount) as total_revenue, COUNT(o.order_id) as order_count
FROM text_to_sql_demo.customers c
JOIN text_to_sql_demo.orders o ON c.customer_id = o.customer_id
GROUP BY c.customer_id, c.name, c.email, c.city
ORDER BY total_revenue DESC
LIMIT 10;
```

**"Show me customers from a specific region"**
```sql
SELECT * FROM text_to_sql_demo.customers 
WHERE state = 'California' OR city = 'New York'
ORDER BY registration_date DESC;
```

**"Find customers at risk of churning"** (no recent orders)
```sql
SELECT c.name, c.email, MAX(o.order_date) as last_order_date,
       DATEDIFF(CURRENT_DATE, MAX(o.order_date)) as days_since_last_order
FROM text_to_sql_demo.customers c
LEFT JOIN text_to_sql_demo.orders o ON c.customer_id = o.customer_id
GROUP BY c.customer_id, c.name, c.email
HAVING days_since_last_order > 90 OR days_since_last_order IS NULL
ORDER BY days_since_last_order DESC;
```

### Product Analysis Questions

**"What are the trending products?"**
```sql
SELECT o.product_name, o.category, COUNT(o.order_id) as order_count, SUM(o.quantity) as total_sold
FROM text_to_sql_demo.orders o
GROUP BY o.product_name, o.category
ORDER BY order_count DESC
LIMIT 10;
```

**"Which products have the highest revenue?"**
```sql
SELECT o.product_name, o.category, SUM(o.total_amount) as total_revenue, COUNT(o.order_id) as order_count
FROM text_to_sql_demo.orders o
GROUP BY o.product_name, o.category
ORDER BY total_revenue DESC
LIMIT 10;
```

**"Show me products in Electronics category"**
```sql
SELECT * FROM text_to_sql_demo.products 
WHERE category = 'Electronics'
ORDER BY price DESC;
```

**"Which products are low in stock?"**
```sql
SELECT product_name, category, stock, price, (price * stock) as inventory_value
FROM text_to_sql_demo.products
WHERE stock < 50
ORDER BY stock ASC;
```

### Sales Analysis Questions

**"What's our sales performance by category?"**
```sql
SELECT category, COUNT(order_id) as total_orders, SUM(total_amount) as total_revenue, 
       AVG(total_amount) as avg_order_value, SUM(quantity) as total_units_sold
FROM text_to_sql_demo.orders
GROUP BY category
ORDER BY total_revenue DESC;
```

**"Show me recent orders"**
```sql
SELECT o.order_id, c.name as customer_name, o.product_name, o.category, o.total_amount, o.order_date
FROM text_to_sql_demo.orders o
JOIN text_to_sql_demo.customers c ON o.customer_id = c.customer_id
ORDER BY o.order_date DESC
LIMIT 20;
```

**"Compare sales performance by region"**
```sql
SELECT c.state, c.country, COUNT(o.order_id) as total_orders, 
       SUM(o.total_amount) as total_revenue, AVG(o.total_amount) as avg_order_value
FROM text_to_sql_demo.customers c
JOIN text_to_sql_demo.orders o ON c.customer_id = o.customer_id
GROUP BY c.state, c.country
ORDER BY total_revenue DESC;
```

### Inventory and Stock Questions

**"Show me high-value inventory"**
```sql
SELECT product_name, category, price, stock, (price * stock) as inventory_value
FROM text_to_sql_demo.products
ORDER BY inventory_value DESC
LIMIT 10;
```

**"Which products need restocking?"**
```sql
SELECT p.product_name, p.category, p.stock, p.price,
       COALESCE(SUM(o.quantity), 0) as total_sold_last_30_days
FROM text_to_sql_demo.products p
LEFT JOIN text_to_sql_demo.orders o ON p.product_name = o.product_name 
    AND o.order_date >= CURRENT_DATE - INTERVAL '30' DAY
WHERE p.stock < 20
GROUP BY p.product_name, p.category, p.stock, p.price
ORDER BY p.stock ASC;
```

## Query Optimization Guidelines

### Performance Best Practices
1. Always use LIMIT for large result sets (default: LIMIT 10)
2. Use appropriate indexes (customer_id, product_name, order_date)
3. Filter early with WHERE clauses
4. Use specific column names instead of SELECT *
5. Consider using EXPLAIN to analyze query performance

### Common Aggregation Patterns
- **COUNT()**: For counting orders, customers, products
- **SUM()**: For total revenue, quantities, amounts
- **AVG()**: For average order values, prices
- **MAX()/MIN()**: For date ranges, price ranges
- **GROUP BY**: Always group by non-aggregated columns
- **ORDER BY**: Sort results meaningfully (DESC for top results)

### Date and Time Queries
```sql
-- Orders from last 30 days
SELECT * FROM text_to_sql_demo.orders 
WHERE order_date >= CURRENT_DATE - INTERVAL '30' DAY;

-- Orders from specific month
SELECT * FROM text_to_sql_demo.orders 
WHERE EXTRACT(MONTH FROM order_date) = 12 
AND EXTRACT(YEAR FROM order_date) = 2024;

-- Monthly sales trend
SELECT EXTRACT(YEAR FROM order_date) as year,
       EXTRACT(MONTH FROM order_date) as month,
       COUNT(order_id) as total_orders,
       SUM(total_amount) as total_revenue
FROM text_to_sql_demo.orders
GROUP BY EXTRACT(YEAR FROM order_date), EXTRACT(MONTH FROM order_date)
ORDER BY year DESC, month DESC;
```

## Business Intelligence Insights

### Key Performance Indicators (KPIs)
- Total Revenue: `SUM(total_amount) FROM orders`
- Total Orders: `COUNT(order_id) FROM orders`
- Average Order Value: `AVG(total_amount) FROM orders`
- Customer Count: `COUNT(DISTINCT customer_id) FROM orders`
- Product Diversity: `COUNT(DISTINCT product_name) FROM orders`
- Active Customers: `COUNT(DISTINCT customer_id) FROM orders WHERE order_date >= CURRENT_DATE - INTERVAL '30' DAY`

### Segmentation Strategies
- **Geographic**: Group by city, state, country
- **Product Category**: Group by category
- **Customer Value**: Segment by total_amount ranges (High: >$1000, Medium: $500-1000, Low: <$500)
- **Order Frequency**: Segment by order count per customer
- **Temporal**: Group by order_date periods (daily, weekly, monthly, quarterly)
- **Product Performance**: Segment by sales volume (Top 20%, Middle 60%, Bottom 20%)

### Advanced Analytics Patterns
```sql
-- Customer Lifetime Value Analysis
SELECT c.name, c.email, c.registration_date,
       COUNT(o.order_id) as total_orders,
       SUM(o.total_amount) as lifetime_value,
       AVG(o.total_amount) as avg_order_value,
       MAX(o.order_date) as last_order_date,
       DATEDIFF(CURRENT_DATE, MAX(o.order_date)) as days_since_last_order
FROM text_to_sql_demo.customers c
LEFT JOIN text_to_sql_demo.orders o ON c.customer_id = o.customer_id
GROUP BY c.customer_id, c.name, c.email, c.registration_date
ORDER BY lifetime_value DESC;
```